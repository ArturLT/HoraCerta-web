{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard - Finanças{% endblock %}

{% block extra_style %}
<link rel="stylesheet" href="{% static 'finance/css/dashboard.css' %}">
{% endblock %}

{% block extra_scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{% static 'finance/js/charts.js' %}"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        renderiza_despesas_mensal("{% url 'finance:relatorio' %}");
    });
</script>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="dashboard-header">
        <h2>Resumo Financeiro</h2>
        <div class="dashboard-actions">
            <button class="btn-refresh" onclick="location.reload()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                </svg>
                Atualizar
            </button>
        </div>
    </div>

    <!-- Grid de Cards de Resumo -->
    <section class="financial-summary">
        <div class="summary-card receita">
            <div class="card-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                </svg>
            </div>
            <h4>Receitas</h4>
            <p class="value">R$ {{ receitas|floatformat:2 }}</p>
            <span class="period-label">Período Atual</span>
        </div>

        <div class="summary-card despesa">
            <div class="card-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2z"/>
                </svg>
            </div>
            <h4>Despesas</h4>
            <p class="value">R$ {{ despesas|floatformat:2 }}</p>
            <span class="period-label">Período Atual</span>
        </div>

        <div class="summary-card saldo">
            <div class="card-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0z"/>
                    <path d="M9 12l2 2 4-4"/>
                </svg>
            </div>
            <h4>Saldo</h4>
            <p class="value">R$ {{ saldo|floatformat:2 }}</p>
            <span class="period-label">Período Atual</span>
        </div>

        <!-- Placeholder para Item Mais Alugado -->
        <div class="summary-card placeholder item-alugado">
            <div class="card-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                    <polyline points="9 22 9 12 15 12 15 22"/>
                </svg>
            </div>
            <h4>Item Mais Alugado</h4>
            <p class="value">--</p>
            <span class="period-label">Em breve</span>
        </div>

        <!-- Placeholder para Histórico de Saldo -->
        <div class="summary-card placeholder historico-saldo">
            <div class="card-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
                </svg>
            </div>
            <h4>Histórico Mensal</h4>
            <p class="value">--</p>
            <span class="period-label">Em breve</span>
        </div>
    </section>

    <!-- Gráfico de Transações -->
    <section class="chart-section">
        <div class="chart-header">
            <h3>Receitas vs Despesas</h3>
            <span class="chart-subtitle">Últimos 12 meses</span>
        </div>
        <div class="chart-container">
            <canvas id="faturamento"></canvas>
        </div>
    </section>
</div>
{% endblock %}
